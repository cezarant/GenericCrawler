<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">           
    <title>Crawler OPS - Secretários Parlamentares</title>    
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" /> 	
	<style>
		/* Move down content because we have a fixed navbar that is 50px tall */
		body 
		{
		  padding-top: 50px;
		  padding-bottom: 20px;
		}
		/* This imageless css button was generated by CSSButtonGenerator.com */	
		.luzApagada
		{
			display: none;
			position:absolute;
			top: 0%;
			left: 0%;
			width: 100%;
			height: 100%;
			background-color: white;
			z-index:1001;
			-moz-opacity: 0.9;
			opacity:.90;
			filter: alpha(opacity=90)
		}
		.luzAcesa
		{
			display: none;
			position: absolute;			
			background-color: white;
			z-index:1002;
			overflow: auto;
		}
		.mensagens{
			height: 200px;
			overflow-y:scroll; 
		}	
  </style>	
  </head>
  <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">          
          <a class="navbar-brand" href="#">Crawler</a>
        </div>        
      </div>
    </nav>        
    <div class="container">
        <div class="row">
            <div class="col-lg-12">                
				<p>
					<button id="iniciarCrawler" type="button" class="btn btn-danger" onclick="iniciarCrawler(2,11)">Iniciar</button>  
				</p>				
				<p>
					<ul class="mensagens" id="messages">									
					</ul>					
				</p>
            </div>
	    </div>      
    </div> <!-- /container -->        	
	<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.js"></script>	
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>	
	<script>
      var socket = io();
	  var etapa = 0; 	  
	  var fimPaginacao = 0;   	  
	  $("#ulRotas").hide();	  
      function iniciarCrawler(inicio, fim)
	  {
		etapa = inicio; 
		fimPaginacao = fim;   	  
		socket.emit('chat message',etapa);
	  }  
      socket.on('chat message', function(msg)
	  { 		
		if((etapa + 1) >= fimPaginacao)
		{			
			alert('Fim da execução. Para recuperar os resultados, acesse as rotas indicadas no fim do Scroll'); 
			$("#ulRotas").show();	  
		}else{
			etapa++;
			$('#messages').append($('<li>').text(msg));
			socket.emit('chat message',etapa);
		} 				
      });
    </script>
  </body>
</html>
